<!DOCTYPE html>
<html>
	<head>
		<!-- Meta tags -->
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>Ready Set Go | Find A Stop</title>

		<!-- CSS -->
		<link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.css">
        <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" type="text/css" href="stylesheet.css">
	</head>
	
	<body>
		<div class="navbar navbar-inverse navbar-static-top">
			<div class="container">
				<p class="navbar-brand">Find a <span class="titleEmphasis">Stop</span></p>
			</div>
		</div>

		<!-- Location Input -->
		<div class="container" id="location-input">
			<div class="input-group">                
				<input type="text" class="form-control" placeholder="Enter Desintation">
				<span class="input-group-btn">
					<button class="btn btn-default" id="search" type="button">Find closest stop</button>
				</span>
			</div>
		</div>

		<!-- Map (Google Maps) -->
		<!--<div class="container">
			<div class="panel panel-default">
				<div class="panel-body">
<!--					 Embeded Google Map -->
					<!--<div class="embed-responsive embed-responsive-4by3">-->
                        <div id="findStopMap">
                            <div class="ui-content" id="map-canvas"></div>
<!--						<iframe class="embed-responsive-item" src="https://www.google.com/maps/embed/v1/place?q=Te%20Aro%2C%20Wellington%2C%20New%20Zealand&key=AIzaSyA-02CDhuOT5nAyGGhq7Cg9Lob5EJDw9ag"></iframe>-->
                       </div>
					<!-- </div>
				</div>
			</div>
		</div> -->

		<!-- Stop Information -->
		<div class="container finalContent">
			<div class="row">
				<div class="col-xs-7">
					<h1>Stop Information</h1>
					<p>Information about the stop would go here.</p>
					<!-- Bus Route Numbers -->
					<button class="label-warning" id="b11">11</button>
					<button class="label-warning" id="b17">17</button>
					<button class="label-warning" id="b42">42</button>
					<button class="label-warning" id="b52">52</button>
					<button class="label-warning" id="b57">57</button>
				</div>
			</div>
		</div>

		<!-- Footer -->
		<div class="navbar navbar-inverse navbar-fixed-bottom">
			<div class="container">
				<a href="index.html">
					<p class="navbar-text"><span class="titleEmphasis"><< HOME</span></p>
				</a>
			</div>
		</div>

		<!-- JS -->
		<script src="js/jquery-1.11.3.min.js"></script>
		<script src="bootstrap/js/bootstrap.js"></script>
        <script src="https://maps-api-ssl.google.com/maps/api/js"></script>
      
        <script type="text/javascript">        
            $(document).ready(function() {
                // Helper function to deal with button events.
                $("button").click(function(event) {
                    switch(event.target.id){
                        case "search":
                            break;
                        case "useFromLocation":
                            break;
                        case "b11":
                            drawPath(11);
                            break;
                        case "b17":
                            drawPath(17);
                            break;
                        case "b42":
                            drawPath(42);
                            break;
                        case "b52":
                            drawPath(52);
                            break;
                        case "b57":
                            drawPath(57);
                            break;
                        default:
                            alert("No button ID found for: "+event.target.id);
                    }
                });

                // For the use location button, will centre map on the current position
                function useLocation(){
                    if(navigator.geolocation){                            
                        navigator.geolocation.getCurrentPosition (function (pos) {
                            var lat = pos.coords.latitude;
                            var lng = pos.coords.longitude;
                            //alert("Lat: "+lat+" Long: " + lng);
                            
                            map.setCenter(new google.maps.LatLng(lat, lng));
                            
                        }, function(){
                            noGeolocation(true);   
                        }, {maximumAge: 500000, enableHighAccuracy:true, timeout: 6000});
                    };
                };

                // What to do if geolocation isn't available
                function noGeolocation(geoError){
                    if(geoError){
                        //alert("Geolocation service failed");
                    } else {
                        alert("Browser/device doesn't support geolocation");
                    }

                    addInputLocation();
                };
                
                // Used to add the from dialogue box when geolocation isn't available
                function addInputLocation(){
                    //Check it hasn't already been added
                    if(document.getElementById("from-input") == null){
                        var fromInput = document.createElement("div");
                        fromInput.setAttribute("id", "from-input");
                        fromInput.setAttribute("class", "input-group");
                        fromInput.innerHTML = '<input type="text" class="form-control" placeholder="Where are you?"><span class="input-group-btn"><button class="btn btn-default" id="useFromLocation" type="button">Use this location</button></span>';
                        $("#location-input").prepend(fromInput);
                    } 
                }
                
                // Used for drawing the given route numbers path
                function drawPath(routeNumber){
                    // Check which route # to draw - remove others?
                    // Get route information & iterate over into array?
                    // Draw on map.
                };
                
                
                function codeAddress() {
                    var address = document.getElementById('address').value;
                    geocoder.geocode( { 'address': address}, function(results, status) {
                        if (status == google.maps.GeocoderStatus.OK) {
                            map.setCenter(results[0].geometry.location);
                            var marker = new google.maps.Marker({
                                map: map,
                                position: results[0].geometry.location
                            });
                        } else {
                            alert('Geocode was not successful for the following reason: ' + status);
                        }
                    });
                }

                
                
                // ******* Map initialisation ******
                var map;
                var geocoder;
                function initialise() {
                    geocoder = new google.maps.Geocoder();
                    var mapOptions = {
                        zoom: 14,
                        scrollwheel: false,
                        navigationControl: false,
                        mapTypeControl: false,
                        scaleControl: false,
                        draggable: false,
                        disableDefaultUI: true,
                        center: new google.maps.LatLng(-41.3, 174.783),
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                    };
                    map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
                }
                
                google.maps.event.addDomListener(window, 'load', initialise);
                useLocation();
            });
        </script>
	</body>
</html>